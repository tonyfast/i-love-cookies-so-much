# From root:
#
# watchmedo tricks docs/_data/tricks.yaml

tricks:
# Compile the script and rerun tests.
- watchdog.tricks.ShellCommandTrick:
    patterns:
    - "*/whatever/*.ipynb"
    ignore_patterns:
        - '*/.~*.ipynb'
        - '*/.ipynb_checkpoints*'
    shell_command: |
        jupyter nbconvert --to html ${watch_src_path} --template=docs/_nbconvert/body.html --output-dir=docs/source/
        jupyter nbconvert --to python "${watch_src_path}"  --template=docs/_nbconvert/python.tpl
        autopep8 --recursive --in-place --verbose . &&
        py.test --flake8




# Only test the test
- watchdog.tricks.ShellCommandTrick:
    patterns:
    - "*/docs/*.ipynb"
    - "*/docs/**/*.ipynb"
    ignore_patterns:
    - '*/.~*.ipynb'
    - '*/.ipynb_checkpoints*'
    - "*/docs/test-*.ipynb"
    # append yaml front matter and liquid tags for jekyll to compile
    # test the file that changes.  every piece of code should be tested in the
    # jekyll site.
    shell_command: |
        py.test ${watch_src_path} &&
        jupyter nbconvert --to html ${watch_src_path} --template=docs/_nbconvert/body.html
